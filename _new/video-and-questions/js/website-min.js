var $=jQuery.noConflict();$(document).ready((function(e){SiteManager.init()}));var SiteManager={mob:!1,myHomeStartButton:$(".js-home-start"),myInstructionsStartButton:$(".js-instructions-start"),myInstructionsScreen:$(".masega-section-instructions"),myIncident1BTScreen:$(".masega-section-incident1-bt"),init:function(){this.mob=!!navigator.userAgent.match(/(Android|webOS|BlackBerry|IEMobile|Opera Mini|iPad|iPhone|iPod)/g),0!=window.orientation&&90!=window.orientation&&-90!=window.orientation&&180!=window.orientation||(this.mob=!0),$(window).resize(this.handleStageResize.bind(this)),this.handleStageResize(),QuestionsManager.init(),DragAnswerManager.init(),$.getJSON("data/data.json",this.onDataLoaded.bind(this)),this.myHomeStartButton.on("click",this.onHomeStartClicked.bind(this)),this.myInstructionsStartButton.on("click",this.onInstructionsStartClicked.bind(this))},getURLParam:function(e){var s=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==s?null:decodeURI(s[1])||0},onDataLoaded:function(e){$(".js-main-image").attr("src",e.startimage),$(".js-personname").html(e.personname),$(".masega-section-instructions h2").html(e.instructions.title),$(".masega-section-instructions .masega-p-container").html(this.getBodyHtml(e.instructions.bodycopy)),$(".masega-section-incident1-bt h2").html(e.incidenttitle),$("#question1 h2").html(e.intro.title),$("#question1 .masega-p-container").html(this.getBodyHtml(e.intro.bodycopy)),$("#question2 h2").html(e.video.title),$("#question3 h2").html(e.answer1.title),$("#question3 .masega-p-container").html(this.getBodyHtml(e.answer1.bodycopy)),$("#question4 h2").html(e.feedbackvideo1.title),$("#question5 h2").html(e.answerreview1.title),$("#question5 .masega-p-container").html(this.getBodyHtml(e.answerreview1.bodycopy)),$("#question6 h2").html(e.answer2.title),$("#question6 .masega-p-container").html(this.getBodyHtml(e.answer2.bodycopy)),$("#question7 h2").html(e.feedbackvideo2.title),$("#question8 h2").html(e.answerreview2.title),$("#question8 .masega-p-container").html(this.getBodyHtml(e.answerreview2.bodycopy)),$("#question9 h2").html(e.finalreview.title),$("#question9 .masega-p-container").html(this.getBodyHtml(e.finalreview.bodycopy)),QuestionsManager.aPersonAnswers["person-answer-1"]=[],QuestionsManager.aPersonAnswers["person-answer-2"]=[];for(var s=0;s<4;s++)QuestionsManager.aPersonAnswers["person-answer-1"].push(100-e.personanswers.data[s].power),QuestionsManager.aPersonAnswers["person-answer-2"].push(e.personanswers.data[s].valance),$(".js-answer-word-"+(s+1)).html(e.personanswers.visual[s]);LocalVideoManager.init([{divID:"video-1",videoID:"clip-1",videopath:e.video.videopath},{divID:"video-2",videoID:"clip-2",videopath:e.feedbackvideo1.videopath},{divID:"video-3",videoID:"clip-3",videopath:e.feedbackvideo2.videopath}]),$(".masega-section-home").fadeIn()},getBodyHtml:function(e){for(var s="",t=0;t<e.length;t++)s+="<p>"+e[t]+"</p>";return s},handleStageResize:function(){var e=.01*window.innerHeight,s=.01*window.innerWidth;document.documentElement.style.setProperty("--vw",s+"px"),document.documentElement.style.setProperty("--vh",e+"px")},onHomeStartClicked:function(){this.myInstructionsScreen.show(),$("html, body").animate({scrollTop:this.myInstructionsScreen.offset().top},500)},onInstructionsStartClicked:function(){this.myIncident1BTScreen.show(),$("html, body").animate({scrollTop:this.myIncident1BTScreen.offset().top},500),QuestionsManager.checkAnswer(0)}},QuestionsManager={LINE_OPTIONS:["maybe","other-than-cultural-difference","cultural-difference"],myQuestions:$(".masega-question"),myNextButtons:$(".masega-question .js-btn-next"),bVideoPerson1IsFinished:!1,bVideoPerson2IsFinished:!1,bVideoPerson3IsFinished:!1,myFinalScreenTheirsToggle:null,myFinalScreenYoursToggle:null,myFinalScreenLines:null,aPersonAnswers:{"person-answer-1":[],"person-answer-2":[]},init:function(){this.myNextButtons.addClass("masega-button--inactive");for(var e=0;e<this.myQuestions.length;e++)$(this.myQuestions[e]).attr("id","question"+e);this.myFinalScreenTheirsToggle=$("#question"+(this.myQuestions.length-1)+" .masega-question__copy-left .masega-drag-answer__theirs"),this.myFinalScreenYoursToggle=$("#question"+(this.myQuestions.length-1)+" .masega-question__copy-left .masega-drag-answer__yours"),this.myFinalScreenLines=$(".masega-drag-answer__connecting-line"),this.myFinalScreenLines.on("click",this.onToggleFinalScreenLineClicked.bind(this))},checkAnswer:function(e){switch(e){case 0:case 1:case 5:case 8:this.changeQuestionStatus(e,!0);break;case 2:this.changeQuestionStatus(e,this.bVideoPerson1IsFinished);break;case 3:this.changeQuestionStatus(e,DragAnswerManager.checkIfAllPlaced("person-answer-1"));break;case 4:this.changeQuestionStatus(e,this.bVideoPerson2IsFinished);break;case 6:this.changeQuestionStatus(e,DragAnswerManager.checkIfAllPlaced("person-answer-2"));break;case 7:this.changeQuestionStatus(e,this.bVideoPerson3IsFinished)}},changeQuestionStatus:function(e,s){s?$(this.myNextButtons[e]).hasClass("masega-button--inactive")&&($(this.myNextButtons[e]).removeClass("masega-button--inactive"),$(this.myNextButtons[e]).on("click",this.onNextClicked.bind(this)),this.unlockNextQuestion(e+1)):$(this.myNextButtons[e]).hasClass("masega-button--inactive")||($(this.myNextButtons[e]).addClass("masega-button--inactive"),$(this.myNextButtons[e]).off("click"))},lockSectionAnswers:function(e){$("#"+e+" .masega-drag-answer").css({pointerEvents:"none"})},onNextClicked:function(e){var s=Number($(e.currentTarget).closest(".masega-question")[0].id.substr(8));console.log("MXT","#question"+(s+1)),$("html, body").animate({scrollTop:$("#question"+(s+1)).offset().top},500),s+1==2&&LocalVideoManager.playVideo("video-1"),s+1==4&&(this.lockSectionAnswers("question3"),LocalVideoManager.playVideo("video-2")),s+1==5&&this.setupAnswerReview("person-answer-1"),s+1==7&&(this.lockSectionAnswers("question6"),LocalVideoManager.playVideo("video-3")),s+1==8&&this.setupAnswerReview("person-answer-2"),s+1==9&&this.setupAnswerReview("person-answer-end")},onShowYoursOnFinalScreenClicked:function(){this.myFinalScreenYoursToggle.removeClass("masega-drag-answer--inactive"),this.myFinalScreenYoursToggle.removeClass("masega-drag-answer--clickable"),this.myFinalScreenTheirsToggle.addClass("masega-drag-answer--inactive"),this.myFinalScreenTheirsToggle.addClass("masega-drag-answer--clickable"),$("#person-answer-end-review .masega-drag-answer__yours").removeClass("masega-drag-answer--inactive"),$("#person-answer-end-review .masega-drag-answer__theirs").addClass("masega-drag-answer--inactive")},onShowTheirsOnFinalScreenClicked:function(){this.myFinalScreenYoursToggle.addClass("masega-drag-answer--inactive"),this.myFinalScreenYoursToggle.addClass("masega-drag-answer--clickable"),this.myFinalScreenTheirsToggle.removeClass("masega-drag-answer--inactive"),this.myFinalScreenTheirsToggle.removeClass("masega-drag-answer--clickable"),$("#person-answer-end-review .masega-drag-answer__theirs").removeClass("masega-drag-answer--inactive"),$("#person-answer-end-review .masega-drag-answer__yours").addClass("masega-drag-answer--inactive")},setupAnswerReview:function(e){var s=DragAnswerManager.getAnswerPositions(e),t=$("#"+e+"-review .masega-drag-answer__yours"),n=$("#"+e+"-review .masega-drag-answer__theirs");if("person-answer-end"==e){var a=DragAnswerManager.getAnswerPositions("person-answer-1"),i=DragAnswerManager.getAnswerPositions("person-answer-2");s=a,this.myFinalScreenYoursToggle.on("click",this.onShowYoursOnFinalScreenClicked.bind(this)),this.myFinalScreenTheirsToggle.on("click",this.onShowTheirsOnFinalScreenClicked.bind(this))}for(var o=0;o<s.length;o++){var r,h,d=100*s[o].x,l=100*s[o].y;switch(e){case"person-answer-1":d="6%",l=this.adjustPos(e,!1,l),r="50%",h=this.adjustPos(e,!1,this.aPersonAnswers[e][o]);break;case"person-answer-2":l=3+20*o+"%",d=this.adjustPos(e,!0,d),h=13+20*o+"%",r=this.adjustPos(e,!0,this.aPersonAnswers[e][o]);break;case"person-answer-end":l=this.adjustPos(e,!1,100*a[o].y),d=this.adjustPos(e,!0,100*i[o].x),h=this.adjustPos(e,!1,this.aPersonAnswers["person-answer-1"][o]),r=this.adjustPos(e,!0,this.aPersonAnswers["person-answer-2"][o])}$(t[o]).css({left:d,top:l}),$(n[o]).css({left:r,top:h})}"person-answer-end"==e&&window.setTimeout(this.handleLines.bind(this),100)},adjustPos:function(e,s,t){t/=100;var n,a=$("#"+e+"-review .masega-drag-answer__yours").width(),i=$("#"+e+"-review .masega-drag-answer__yours").height(),o=$("#"+e+"-review .masega-drag-answer__area").width(),r=$("#"+e+"-review .masega-drag-answer__area").height();return n=s?t*(o-a)+"px":t*(r-i)+"px",console.log(a,i,o,r,t,n),n},handleLines:function(){for(var e=$("#person-answer-end-review .masega-drag-answer__yours"),s=$("#person-answer-end-review .masega-drag-answer__theirs"),t=$("#person-answer-end-review .masega-general-container").offset(),n=0;n<e.length;n++)this.adjustLine($(e[n]),$(s[n]),$($("#person-answer-end-review .masega-drag-answer__connecting-line")[n]),t)},onToggleFinalScreenLineClicked:function(e){for(var s=0,t=0;t<this.LINE_OPTIONS.length;t++)$(e.currentTarget).hasClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[t])&&(s=t,$(e.currentTarget).removeClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[t]));++s==this.LINE_OPTIONS.length&&(s=0),$(e.currentTarget).addClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[s])},unlockNextQuestion:function(e){console.log("unlockNextQuestion",e),$(this.myQuestions[e]).show(),this.checkAnswer(e)},onVideoFinished:function(e){switch(e){case"video-1":this.bVideoPerson1IsFinished=!0,this.checkAnswer(2);break;case"video-2":this.bVideoPerson2IsFinished=!0,this.checkAnswer(4);break;case"video-3":this.bVideoPerson3IsFinished=!0,this.checkAnswer(7)}},adjustLine:function(e,s,t,n){var a=e.offset().top+e.height()/2,i=s.offset().top+s.height()/2,o=e.offset().left+e.width()/2,r=s.offset().left+s.width()/2,h=Math.abs(i-a),d=Math.abs(r-o),l=Math.sqrt(h*h+d*d),c=180/Math.PI*Math.acos(h/l);if(i>a)var g=(i-a)/2+a;else g=(a-i)/2+i;if(r>o)var m=(r-o)/2+o;else m=(o-r)/2+r;(a<i&&o<r||i<a&&r<o||a>i&&o>r||i>a&&r>o)&&(c*=-1),g-=l/2,g-=n.top,m-=n.left,t.css({"-webkit-transform":"rotate("+c+"deg)","-moz-transform":"rotate("+c+"deg)","-ms-transform":"rotate("+c+"deg)","-o-transform":"rotate("+c+"deg)",transform:"rotate("+c+"deg)",top:g+"px",left:m+"px",height:l+"px"})}},LocalVideoManager={myPlayers:null,myVideoDiv:$(".masega-question__video"),sCurrentVideoPlayerID:"",init:function(e){this.setupPlayers(e)},playVideo:function(e){this.sCurrentVideoPlayerID=e,this.myPlayers[e][0].play(),this.myPlayers[e].on("ended",this.onVideoComplete.bind(this))},stopVideo:function(e){},hideVideo:function(){this.myVideoDiv.hide()},setupPlayers:function(e){this.myPlayers={};for(var s=0;s<e.length;s++)$("#"+e[s].divID).html('<video src="'+e[s].videopath+'" playsinline controls></video>'),this.myPlayers[e[s].divID]=$("#"+e[s].divID+" video")},onVideoComplete:function(e){console.log("onVideoComplete",this.sCurrentVideoPlayerID),this.myPlayers[this.sCurrentVideoPlayerID].off("ended"),QuestionsManager.onVideoFinished(this.sCurrentVideoPlayerID)}},YouTubeManager={myPlayers:null,bAPIReady:!1,myVideoDiv:$(".masega-question__video"),sCurrentVideoPlayerID:"",init:function(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(e,s)},playVideo:function(e){this.myPlayers[e]&&(this.myPlayers[e].playVideo(),this.sCurrentVideoPlayerID=e)},stopVideo:function(e){this.myPlayers[e]&&this.myPlayers[e].stopVideo()},hideVideo:function(){this.myVideoDiv.hide()},onAPIReady:function(){console.log("onAPIReady"),this.bAPIReady=!0,this.setupPlayers([{divID:"video-1",videoID:"5_sfnQDr1-o"},{divID:"video-2",videoID:"t6wCykq_bLo"},{divID:"video-3",videoID:"Q9MFDKka0Bw"}])},setupPlayers:function(e){this.myPlayers={};for(var s=0;s<e.length;s++)this.myPlayers[e[s].divID]=new YT.Player(e[s].divID,{height:"100%",width:"100%",videoId:e[s].videoID,events:{onReady:YouTubeManager.onPlayerReady.bind(YouTubeManager),onStateChange:YouTubeManager.onPlayerStateChange.bind(YouTubeManager)}})},onPlayerReady:function(){},onPlayerStateChange:function(e){this.sCurrentVideoPlayerID=e.target.m.id,0==e.data&&QuestionsManager.onVideoFinished(this.sCurrentVideoPlayerID)}};function onYouTubeIframeAPIReady(){YouTubeManager.onAPIReady()}var DragAnswerManager={myDragAnswer:$(".masega-drag-answer"),myAnswers:{},myAnswersData:{},init:function(){for(var e=0;e<this.myDragAnswer.length;e++){var s=$(this.myDragAnswer[e]).attr("id");this.myAnswers[s]=[];for(var t=0;t<4;t++){var n=new DragableAnswerItem(s,s+"dai"+t,"area"+e);n.activateInteractions(),this.myAnswers[s].push(n)}}},checkIfAllPlaced:function(e){this.myAnswersData[e]=[];for(var s=!0,t=0;t<this.myAnswers[e].length;t++){var n=this.myAnswers[e][t].checkIfInArea();n.isOk?this.myAnswersData[e].push(n):s=!1}return s},getAnswerPositions:function(e){return this.myAnswersData[e]}},DragableAnswerItem=function(e,s,t){this.oLastPos={left:0,top:0},this.bIsDragging=!1,this.myArea=$("#"+t),this.myVisual=$("#"+s),this.myBaseSpot=$("#bs"+s),this.myAnswerID=e,this.hammerRef=new Hammer(document.getElementById(s)),this.hammerRef.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0})),this.hammerRef.add(new Hammer.Tap)};DragableAnswerItem.prototype.activateInteractions=function(){this.hammerRef.on("pan",this.handleDrag.bind(this)),this.hammerRef.on("tap",this.handleTap.bind(this))},DragableAnswerItem.prototype.deActivateInteractions=function(){this.hammerRef.off("pan"),this.hammerRef.off("tap")},DragableAnswerItem.prototype.handleTap=function(e){},DragableAnswerItem.prototype.handleDrag=function(e){this.bIsDragging||(this.bIsDragging=!0,this.oLastPos=this.myVisual.position(),this.myVisual.addClass("masega-drag-answer__dragable--top"));var s=e.deltaX+this.oLastPos.left,t=e.deltaY+this.oLastPos.top;if(this.myVisual.css({left:s+"px",top:t+"px"}),e.isFinal)switch(this.myVisual.removeClass("masega-drag-answer__dragable--top"),this.checkIfInArea(),this.bIsDragging=!1,this.myAnswerID){case"person-answer-1":QuestionsManager.checkAnswer(3);break;case"person-answer-2":QuestionsManager.checkAnswer(6)}},DragableAnswerItem.prototype.checkIfInArea=function(){var e=this.myVisual.position(),s=this.myArea.position(),t=this.myVisual.width(),n=this.myArea.width(),a=this.myVisual.height(),i=this.myArea.height(),o={isOk:!1,x:0,y:0};if(e.left>=s.left&&e.left<s.left+n-t&&e.top>=s.top&&e.top<s.top+i-a&&(o.isOk=!0,o.x=(e.left-s.left)/(n-t),o.y=(e.top-s.top)/(i-a)),!o.isOk){var r=this.myBaseSpot.position();this.myVisual.css({left:r.left+"px",top:r.top+"px"})}return console.log(o),o};
//# sourceMappingURL=website-min.js.map