var $=jQuery.noConflict();$(document).ready((function(e){SiteManager.init()}));var SiteManager={mob:!1,myHomeStartButton:$(".js-home-start"),myInstructionsStartButton:$(".js-instructions-start"),myInstructionsScreen:$(".masega-section-instructions"),myIncident1BTScreen:$(".masega-section-incident1-bt"),init:function(){this.mob=!!navigator.userAgent.match(/(Android|webOS|BlackBerry|IEMobile|Opera Mini|iPad|iPhone|iPod)/g),0!=window.orientation&&90!=window.orientation&&-90!=window.orientation&&180!=window.orientation||(this.mob=!0),$(window).resize(this.handleStageResize.bind(this)),this.handleStageResize(),QuestionsManager.init(),DragAnswerManager.init(),$(".masega-section-home").fadeIn(),$.getJSON("data/data.json",this.onDataLoaded.bind(this)),this.myHomeStartButton.on("click",this.onHomeStartClicked.bind(this)),this.myInstructionsStartButton.on("click",this.onInstructionsStartClicked.bind(this))},getURLParam:function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:decodeURI(t[1])||0},onDataLoaded:function(e){$(".js-personname").html(e.personname),$(".masega-section-instructions h2").html(e.instructions.title),$(".masega-section-instructions .masega-p-container").html(this.getBodyHtml(e.instructions.bodycopy)),$(".masega-section-incident1-bt h2").html(e.incidenttitle),$("#question1 h2").html(e.intro.title),$("#question1 .masega-p-container").html(this.getBodyHtml(e.intro.bodycopy)),$("#question2 h2").html(e.video.title),$("#question3 h2").html(e.answer1.title),$("#question3 .masega-p-container").html(this.getBodyHtml(e.answer1.bodycopy)),$("#question4 h2").html(e.feedbackvideo1.title),$("#question5 h2").html(e.answerreview1.title),$("#question5 .masega-p-container").html(this.getBodyHtml(e.answerreview1.bodycopy)),$("#question6 h2").html(e.answer2.title),$("#question6 .masega-p-container").html(this.getBodyHtml(e.answer2.bodycopy)),$("#question7 h2").html(e.feedbackvideo2.title),$("#question8 h2").html(e.answerreview2.title),$("#question8 .masega-p-container").html(this.getBodyHtml(e.answerreview2.bodycopy)),$("#question9 h2").html(e.finalreview.title),$("#question9 .masega-p-container").html(this.getBodyHtml(e.finalreview.bodycopy)),QuestionsManager.aGunterAnswers["gunter-1"]=[],QuestionsManager.aGunterAnswers["gunter-2"]=[];for(var t=0;t<4;t++)QuestionsManager.aGunterAnswers["gunter-1"].push(100-e.personanswers.data[t].power),QuestionsManager.aGunterAnswers["gunter-2"].push(e.personanswers.data[t].valance),$(".js-answer-word-"+(t+1)).html(e.personanswers.visual[t]);LocalVideoManager.init([{divID:"gunter-1",videoID:e.video.video},{divID:"gunter-2",videoID:e.feedbackvideo1.video},{divID:"gunter-3",videoID:e.feedbackvideo2.video}])},getBodyHtml:function(e){for(var t="",s=0;s<e.length;s++)t+="<p>"+e[s]+"</p>";return t},handleStageResize:function(){var e=.01*window.innerHeight,t=.01*window.innerWidth;document.documentElement.style.setProperty("--vw",t+"px"),document.documentElement.style.setProperty("--vh",e+"px")},onHomeStartClicked:function(){this.myInstructionsScreen.show(),$("html, body").animate({scrollTop:this.myInstructionsScreen.offset().top},500)},onInstructionsStartClicked:function(){this.myIncident1BTScreen.show(),$("html, body").animate({scrollTop:this.myIncident1BTScreen.offset().top},500),QuestionsManager.checkAnswer(0)}},QuestionsManager={LINE_OPTIONS:["maybe","other-than-cultural-difference","cultural-difference"],myQuestions:$(".masega-question"),myNextButtons:$(".masega-question .js-btn-next"),bVideoGunter1IsFinished:!1,bVideoGunter2IsFinished:!1,bVideoGunter3IsFinished:!1,myFinalScreenTheirsToggle:null,myFinalScreenYoursToggle:null,myFinalScreenLines:null,aGunterAnswers:{"gunter-1":[],"gunter-2":[]},init:function(){this.myNextButtons.addClass("masega-button--inactive");for(var e=0;e<this.myQuestions.length;e++)$(this.myQuestions[e]).attr("id","question"+e);this.myFinalScreenTheirsToggle=$("#question"+(this.myQuestions.length-1)+" .masega-question__copy-left .masega-drag-answer__theirs"),this.myFinalScreenYoursToggle=$("#question"+(this.myQuestions.length-1)+" .masega-question__copy-left .masega-drag-answer__yours"),this.myFinalScreenLines=$(".masega-drag-answer__connecting-line"),this.myFinalScreenLines.on("click",this.onToggleFinalScreenLineClicked.bind(this))},checkAnswer:function(e){switch(e){case 0:case 1:case 5:case 8:this.changeQuestionStatus(e,!0);break;case 2:this.changeQuestionStatus(e,this.bVideoGunter1IsFinished);break;case 3:this.changeQuestionStatus(e,DragAnswerManager.checkIfAllPlaced("gunter-1"));break;case 4:this.changeQuestionStatus(e,this.bVideoGunter2IsFinished);break;case 6:this.changeQuestionStatus(e,DragAnswerManager.checkIfAllPlaced("gunter-2"));break;case 7:this.changeQuestionStatus(e,this.bVideoGunter3IsFinished)}},changeQuestionStatus:function(e,t){t?$(this.myNextButtons[e]).hasClass("masega-button--inactive")&&($(this.myNextButtons[e]).removeClass("masega-button--inactive"),$(this.myNextButtons[e]).on("click",this.onNextClicked.bind(this)),this.unlockNextQuestion(e+1)):$(this.myNextButtons[e]).hasClass("masega-button--inactive")||($(this.myNextButtons[e]).addClass("masega-button--inactive"),$(this.myNextButtons[e]).off("click"))},lockSectionAnswers:function(e){$("#"+e+" .masega-drag-answer").css({pointerEvents:"none"})},onNextClicked:function(e){var t=Number($(e.currentTarget).closest(".masega-question")[0].id.substr(8));console.log("MXT","#question"+(t+1)),$("html, body").animate({scrollTop:$("#question"+(t+1)).offset().top},500),t+1==2&&LocalVideoManager.playVideo("gunter-1"),t+1==4&&(this.lockSectionAnswers("question3"),LocalVideoManager.playVideo("gunter-2")),t+1==5&&this.setupAnswerReview("gunter-1"),t+1==7&&(this.lockSectionAnswers("question6"),LocalVideoManager.playVideo("gunter-3")),t+1==8&&this.setupAnswerReview("gunter-2"),t+1==9&&this.setupAnswerReview("gunter-end")},onShowYoursOnFinalScreenClicked:function(){this.myFinalScreenYoursToggle.removeClass("masega-drag-answer--inactive"),this.myFinalScreenYoursToggle.removeClass("masega-drag-answer--clickable"),this.myFinalScreenTheirsToggle.addClass("masega-drag-answer--inactive"),this.myFinalScreenTheirsToggle.addClass("masega-drag-answer--clickable"),$("#gunter-end-review .masega-drag-answer__yours").removeClass("masega-drag-answer--inactive"),$("#gunter-end-review .masega-drag-answer__theirs").addClass("masega-drag-answer--inactive")},onShowTheirsOnFinalScreenClicked:function(){this.myFinalScreenYoursToggle.addClass("masega-drag-answer--inactive"),this.myFinalScreenYoursToggle.addClass("masega-drag-answer--clickable"),this.myFinalScreenTheirsToggle.removeClass("masega-drag-answer--inactive"),this.myFinalScreenTheirsToggle.removeClass("masega-drag-answer--clickable"),$("#gunter-end-review .masega-drag-answer__theirs").removeClass("masega-drag-answer--inactive"),$("#gunter-end-review .masega-drag-answer__yours").addClass("masega-drag-answer--inactive")},setupAnswerReview:function(e){var t=DragAnswerManager.getAnswerPositions(e),s=$("#"+e+"-review .masega-drag-answer__yours"),n=$("#"+e+"-review .masega-drag-answer__theirs");if("gunter-end"==e){var i=DragAnswerManager.getAnswerPositions("gunter-1"),a=DragAnswerManager.getAnswerPositions("gunter-2");t=i,this.myFinalScreenYoursToggle.on("click",this.onShowYoursOnFinalScreenClicked.bind(this)),this.myFinalScreenTheirsToggle.on("click",this.onShowTheirsOnFinalScreenClicked.bind(this))}for(var r=0;r<t.length;r++){var o,h,d=100*t[r].x,l=100*t[r].y;switch(e){case"gunter-1":d="6%",l=this.adjustPos(e,!1,l),o="50%",h=this.adjustPos(e,!1,this.aGunterAnswers[e][r]);break;case"gunter-2":l=3+20*r+"%",d=this.adjustPos(e,!0,d),h=13+20*r+"%",o=this.adjustPos(e,!0,this.aGunterAnswers[e][r]);break;case"gunter-end":l=this.adjustPos(e,!1,100*i[r].y),d=this.adjustPos(e,!0,100*a[r].x),h=this.adjustPos(e,!1,this.aGunterAnswers["gunter-1"][r]),o=this.adjustPos(e,!0,this.aGunterAnswers["gunter-2"][r])}$(s[r]).css({left:d,top:l}),$(n[r]).css({left:o,top:h})}"gunter-end"==e&&window.setTimeout(this.handleLines.bind(this),100)},adjustPos:function(e,t,s){s/=100;var n,i=$("#"+e+"-review .masega-drag-answer__yours").width(),a=$("#"+e+"-review .masega-drag-answer__yours").height(),r=$("#"+e+"-review .masega-drag-answer__area").width(),o=$("#"+e+"-review .masega-drag-answer__area").height();return n=t?s*(r-i)+"px":s*(o-a)+"px",console.log(i,a,r,o,s,n),n},handleLines:function(){for(var e=$("#gunter-end-review .masega-drag-answer__yours"),t=$("#gunter-end-review .masega-drag-answer__theirs"),s=$("#gunter-end-review .masega-general-container").offset(),n=0;n<e.length;n++)this.adjustLine($(e[n]),$(t[n]),$($("#gunter-end-review .masega-drag-answer__connecting-line")[n]),s)},onToggleFinalScreenLineClicked:function(e){for(var t=0,s=0;s<this.LINE_OPTIONS.length;s++)$(e.currentTarget).hasClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[s])&&(t=s,$(e.currentTarget).removeClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[s]));++t==this.LINE_OPTIONS.length&&(t=0),$(e.currentTarget).addClass("masega-drag-answer__connecting-line--"+this.LINE_OPTIONS[t])},unlockNextQuestion:function(e){console.log("unlockNextQuestion",e),$(this.myQuestions[e]).show(),this.checkAnswer(e)},onVideoFinished:function(e){switch(e){case"gunter-1":this.bVideoGunter1IsFinished=!0,this.checkAnswer(2);break;case"gunter-2":this.bVideoGunter2IsFinished=!0,this.checkAnswer(4);break;case"gunter-3":this.bVideoGunter3IsFinished=!0,this.checkAnswer(7)}},adjustLine:function(e,t,s,n){var i=e.offset().top+e.height()/2,a=t.offset().top+t.height()/2,r=e.offset().left+e.width()/2,o=t.offset().left+t.width()/2,h=Math.abs(a-i),d=Math.abs(o-r),l=Math.sqrt(h*h+d*d),g=180/Math.PI*Math.acos(h/l);if(a>i)var u=(a-i)/2+i;else u=(i-a)/2+a;if(o>r)var c=(o-r)/2+r;else c=(r-o)/2+o;(i<a&&r<o||a<i&&o<r||i>a&&r>o||a>i&&o>r)&&(g*=-1),u-=l/2,u-=n.top,c-=n.left,s.css({"-webkit-transform":"rotate("+g+"deg)","-moz-transform":"rotate("+g+"deg)","-ms-transform":"rotate("+g+"deg)","-o-transform":"rotate("+g+"deg)",transform:"rotate("+g+"deg)",top:u+"px",left:c+"px",height:l+"px"})}},LocalVideoManager={myPlayers:null,myVideoDiv:$(".masega-question__video"),sCurrentVideoPlayerID:"",init:function(e){this.setupPlayers(e)},playVideo:function(e){this.sCurrentVideoPlayerID=e,this.myPlayers[e][0].play(),this.myPlayers[e].on("ended",this.onVideoComplete.bind(this))},stopVideo:function(e){},hideVideo:function(){this.myVideoDiv.hide()},setupPlayers:function(e){this.myPlayers={};for(var t=0;t<e.length;t++)$("#"+e[t].divID).html('<video src="video/'+e[t].videoID+'.mp4" playsinline controls></video>'),this.myPlayers[e[t].divID]=$("#"+e[t].divID+" video")},onVideoComplete:function(e){console.log("onVideoComplete",this.sCurrentVideoPlayerID),this.myPlayers[this.sCurrentVideoPlayerID].off("ended"),QuestionsManager.onVideoFinished(this.sCurrentVideoPlayerID)}},YouTubeManager={myPlayers:null,bAPIReady:!1,myVideoDiv:$(".masega-question__video"),sCurrentVideoPlayerID:"",init:function(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},playVideo:function(e){this.myPlayers[e]&&(this.myPlayers[e].playVideo(),this.sCurrentVideoPlayerID=e)},stopVideo:function(e){this.myPlayers[e]&&this.myPlayers[e].stopVideo()},hideVideo:function(){this.myVideoDiv.hide()},onAPIReady:function(){console.log("onAPIReady"),this.bAPIReady=!0,this.setupPlayers([{divID:"gunter-1",videoID:"5_sfnQDr1-o"},{divID:"gunter-2",videoID:"t6wCykq_bLo"},{divID:"gunter-3",videoID:"Q9MFDKka0Bw"}])},setupPlayers:function(e){this.myPlayers={};for(var t=0;t<e.length;t++)this.myPlayers[e[t].divID]=new YT.Player(e[t].divID,{height:"100%",width:"100%",videoId:e[t].videoID,events:{onReady:YouTubeManager.onPlayerReady.bind(YouTubeManager),onStateChange:YouTubeManager.onPlayerStateChange.bind(YouTubeManager)}})},onPlayerReady:function(){},onPlayerStateChange:function(e){this.sCurrentVideoPlayerID=e.target.m.id,0==e.data&&QuestionsManager.onVideoFinished(this.sCurrentVideoPlayerID)}};function onYouTubeIframeAPIReady(){YouTubeManager.onAPIReady()}var DragAnswerManager={myDragAnswer:$(".masega-drag-answer"),myAnswers:{},myAnswersData:{},init:function(){for(var e=0;e<this.myDragAnswer.length;e++){var t=$(this.myDragAnswer[e]).attr("id");this.myAnswers[t]=[];for(var s=0;s<4;s++){var n=new DragableAnswerItem(t,t+"dai"+s,"area"+e);n.activateInteractions(),this.myAnswers[t].push(n)}}},checkIfAllPlaced:function(e){this.myAnswersData[e]=[];for(var t=!0,s=0;s<this.myAnswers[e].length;s++){var n=this.myAnswers[e][s].checkIfInArea();n.isOk?this.myAnswersData[e].push(n):t=!1}return t},getAnswerPositions:function(e){return this.myAnswersData[e]}},DragableAnswerItem=function(e,t,s){this.oLastPos={left:0,top:0},this.bIsDragging=!1,this.myArea=$("#"+s),this.myVisual=$("#"+t),this.myBaseSpot=$("#bs"+t),this.myAnswerID=e,this.hammerRef=new Hammer(document.getElementById(t)),this.hammerRef.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0})),this.hammerRef.add(new Hammer.Tap)};DragableAnswerItem.prototype.activateInteractions=function(){this.hammerRef.on("pan",this.handleDrag.bind(this)),this.hammerRef.on("tap",this.handleTap.bind(this))},DragableAnswerItem.prototype.deActivateInteractions=function(){this.hammerRef.off("pan"),this.hammerRef.off("tap")},DragableAnswerItem.prototype.handleTap=function(e){},DragableAnswerItem.prototype.handleDrag=function(e){this.bIsDragging||(this.bIsDragging=!0,this.oLastPos=this.myVisual.position(),this.myVisual.addClass("masega-drag-answer__dragable--top"));var t=e.deltaX+this.oLastPos.left,s=e.deltaY+this.oLastPos.top;if(this.myVisual.css({left:t+"px",top:s+"px"}),e.isFinal)switch(this.myVisual.removeClass("masega-drag-answer__dragable--top"),this.checkIfInArea(),this.bIsDragging=!1,this.myAnswerID){case"gunter-1":QuestionsManager.checkAnswer(3);break;case"gunter-2":QuestionsManager.checkAnswer(6)}},DragableAnswerItem.prototype.checkIfInArea=function(){var e=this.myVisual.position(),t=this.myArea.position(),s=this.myVisual.width(),n=this.myArea.width(),i=this.myVisual.height(),a=this.myArea.height(),r={isOk:!1,x:0,y:0};if(e.left>=t.left&&e.left<t.left+n-s&&e.top>=t.top&&e.top<t.top+a-i&&(r.isOk=!0,r.x=(e.left-t.left)/(n-s),r.y=(e.top-t.top)/(a-i)),!r.isOk){var o=this.myBaseSpot.position();this.myVisual.css({left:o.left+"px",top:o.top+"px"})}return console.log(r),r};
//# sourceMappingURL=website-min.js.map